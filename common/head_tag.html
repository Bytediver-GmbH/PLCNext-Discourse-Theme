<!-- PLCNext Community Header Theme -->
<meta name="theme-name" content="PLCNext Community Header Theme">
<meta name="theme-version" content="2.0.0">

<!-- PLCNext Navigation Template -->
<template id="plcnext-header-template">
  <nav class="main-navigation">
    <ul class="nav-menu">
      <li class="nav-item">
        <a href="https://www.plcnext-community.net/infocenter/news" class="nav-link">News & Articles</a>
      </li>
      <li class="nav-item">
        <a href="https://www.plcnext-community.net/about-plcnext-technology" class="nav-link">About PLCnext Technology</a>
      </li>
      <li class="nav-item">
        <a href="https://www.plcnext-community.net/learning" class="nav-link">Learning</a>
      </li>
      <li class="nav-item">
        <a href="https://www.plcnext-community.net/makers-blog" class="nav-link">Maker's Blog</a>
      </li>
      <li class="nav-item">
        <a href="/" class="nav-link nav-link-active">Forum</a>
      </li>
      <li class="nav-item">
        <a href="https://www.plcnext-community.net/getting-started-with-plcnext-technology/#learn-more" class="nav-link nav-link-cta">Getting started</a>
      </li>
    </ul>
  </nav>
</template>

<script>
function insertPLCNextHeader() {
    // Instead of replacing, modify the existing Discourse header
    const discourseHeader = document.querySelector('#site-header') || document.querySelector('.d-header');
    if (!discourseHeader) return;

    // Remove existing PLCNext modifications
    const existingPLCNext = discourseHeader.querySelector('.plcnext-navigation');
    if (existingPLCNext) existingPLCNext.remove();

    // Add PLCNext logo and navigation
    const template = document.getElementById('plcnext-header-template');
    if (!template) return;

    const headerContent = template.content.cloneNode(true);
    const plcnextNav = headerContent.querySelector('.main-navigation');

    if (plcnextNav) {
        plcnextNav.classList.add('plcnext-navigation');
        // Insert after the logo or at the beginning of the header contents
        const headerContents = discourseHeader.querySelector('.contents') || discourseHeader;
        const logo = headerContents.querySelector('.logo-mobile') || headerContents.querySelector('.title');

        if (logo && logo.nextSibling) {
            headerContents.insertBefore(plcnextNav, logo.nextSibling);
        } else {
            headerContents.appendChild(plcnextNav);
        }
    }

    // Replace logo if needed
    replaceLogo();

    initializePLCNextHeader();
}

function replaceLogo() {
    const logoContainers = document.querySelectorAll('#site-header .logo-mobile, #site-header .title, .d-header .logo-mobile, .d-header .title');

    logoContainers.forEach(container => {
        const logoLink = container.querySelector('a') || container;
        if (logoLink) {
            logoLink.href = 'https://www.plcnext-community.net';

            const logoImg = logoLink.querySelector('img');
            if (logoImg) {
                logoImg.src = 'https://www.plcnext-community.net/app/themes/plcnextcommunity/static/images/logo-plc-next.svg';
                logoImg.alt = 'PLCnext Community';
                logoImg.style.height = '45px';
                logoImg.style.width = 'auto';
            }
        }
    });
}

function initializePLCNextHeader() {
    // Since we're now using the original Discourse header, we don't need custom functionality
    // The hamburger menu and user menu will work automatically with Discourse's built-in functionality
}

// Initialize
document.addEventListener('DOMContentLoaded', insertPLCNextHeader);
if (document.readyState !== 'loading') insertPLCNextHeader();

// Reinitialize on page changes for SPA
let lastUrl = location.href;
new MutationObserver(() => {
    const url = location.href;
    if (url !== lastUrl) {
        lastUrl = url;
        setTimeout(insertPLCNextHeader, 300);
    }
}).observe(document, { subtree: true, childList: true });
</script>

